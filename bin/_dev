#!/bin/bash


# Start server
# ==============================================
chown -R 5000.5000 /usr/lib/ckan/ /etc/ckan/ /var/lib/ckan/

# Import env
SCRIPT_HOME="/etc/easyckan/bin"
source $SCRIPT_HOME/_tools

# Start CKAN containers dependences
echo "# Create network and start PostgreSQL & Solr..."
ckan-create-network
ckan-postgresql
ckan-solr

# Start server
echo ""
echo "# Start EasyCKAN server..."
docker run --net=easyckan --rm -it \
        -v /usr/lib/ckan:/usr/lib/ckan \
        -v /etc/ckan:/etc/ckan \
        -v /var/lib/ckan:/var/lib/ckan \
        -p 5000:5000 \
        easyckan/ckan-dev:$V_CKAN_BASE_VERSION /bin/bash